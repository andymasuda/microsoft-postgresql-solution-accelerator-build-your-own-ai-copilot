# Understanding the Table Schema and Artifacts

This section provides an overview of the **table schema and data artifacts** (e.g., **SOW documents, invoices, and validation results**) used in the **solution accelerator**. It highlights **key fields** that enable AI-powered processing and explains why specific fields are used by **AI services**.

???+ info "Using your own data?"
        For users **adapting the accelerator** to their own data, this guide helps identify where **modifications** may be required to align with their existing **PostgreSQL schema** and **data structures**.

---

## 1. Understanding the Table Schema

The accelerator processes **Statements of Work (SOWs), invoices, validation results, and extracted entities** using a structured PostgreSQL schema. Below is an overview of the **key tables** and their roles:

### **Core Tables & Their Purpose**
| **Table**                   | **Description** |
|-----------------------------|-----------------------------------------------------------|
| `vendors`                   | Stores vendor details, linking them to associated SOWs and invoices. |
| `sows`                      | Contains information on Statements of Work, including terms, parties involved, and deliverables. |
| `sow_chunks`                | Breaks down SOW documents into smaller sections for AI processing. |
| `milestones`                | Tracks contractual milestones extracted from SOWs. |
| `deliverables`              | Details key deliverables as defined in SOWs. |
| `sow_validation_results`    | Stores AI-driven validation results for SOW compliance and consistency. |
| `invoices`                  | Contains invoice details, such as amounts, due dates, and associated SOWs. |
| `invoice_line_items`        | Stores individual line items extracted from invoices. |
| `invoice_validation_results`| Captures AI-driven validation for invoice accuracy and discrepancies. |

### **How These Tables Work Together**

1. **SOW documents** are processed and broken into structured chunks.  
2. AI services extract key entities (**vendors, deliverables, milestones**).  
3. The extracted information is validated and stored in **validation tables**.  
4. **Invoices** are linked to **SOWs** for contract compliance checks.  

When **adapting the accelerator** to a different dataset, users should identify **similar structures in their own database** and **map their entities to these tables**.

---

## 2. Key Fields Used in AI Processing

The solution accelerator integrates with **Azure AI services** to extract, validate, and process information. Below are **key fields** that play a role in AI workflows and why they were selected.

### **Fields Used in AI Services**

| **Field Name**              | **Table**                  | **AI Usage** |
|----------------------------|---------------------------|-------------------------------------------|
| `text_content`             | `sow_chunks`              | AI processes this field to extract structured data from raw SOW text. |
| `embedding_vector`         | `sow_chunks`, `invoice_line_items` | Used for vector search and similarity retrieval in **semantic search models**. |
| `milestone_due_date`       | `milestones`              | AI extracts and validates contract deadlines. |
| `invoice_total`            | `invoices`                | AI checks for discrepancies in invoice processing. |
| `validation_status`        | `sow_validation_results`, `invoice_validation_results` | AI-driven validation results for compliance analysis. |
| `entity_type`              | `sow_chunks`, `invoice_line_items` | AI categorizes extracted entities (e.g., company name, service description). |
| `relation_graph`           | `vendors`, `sows`, `invoices` | AI builds relationships between vendors, SOWs, and invoices for **GraphRAG**-based retrieval. |

### **Why These Fields Matter**

- **Vector embeddings (`embedding_vector`)** enable **semantic search** by allowing **AI-powered retrieval** of similar SOW clauses, contract terms, and invoices.  
- **Validation fields (`validation_status`)** ensure AI-generated extractions meet business rules.  
- **Entity categorization (`entity_type`)** enables fine-grained AI-driven **query answering**.  
- **Graph relationships (`relation_graph`)** support **GraphRAG (Retrieval-Augmented Generation)** for enhanced AI accuracy.  

---

## 3. Adapting the Accelerator to Your Own Data  

If you are using your **own PostgreSQL database**, you will need to:  

### **1. Map Your Data to the Existing Schema**

- Identify **which of your tables correspond** to `sows`, `invoices`, and `vendors`.  
- Ensure your **data can be chunked and processed** similarly to `sow_chunks`.  

### **2. Add Vector Embeddings to Enable AI Search**

- Create a **vector column (`embedding_vector`)** in relevant tables to store AI-generated embeddings.  
- Use **pgvector** or **pg_diskann** for efficient AI-powered search.  

### **3. Modify AI Processing Scripts**

- Update **data extraction scripts** to reflect your field names.  
- Ensure AI models **extract the correct entities** based on your schema.  

### **4. Update Data Export & Relationships**

- Modify data export scripts to align with **your table structure**.  
- Ensure **GraphRAG relationships** correctly link entities in your database.  
